# distributed-file-management-system
# 3-Tiered Web App
## Demo
https://github.com/wwaihoe/distributed-file-management-system/assets/91514179/bd5619e5-58ba-41fb-8e09-a8beb530e034

Home page:
![image](https://github.com/wwaihoe/distributed-file-management-system/assets/91514179/4b37be05-be4b-48e9-9ad7-021c7c91075d)

Select file to upload:
![image](https://github.com/wwaihoe/distributed-file-management-system/assets/91514179/c7c4d9da-24da-4735-9d2a-de419494c4f4)

See uploaded file (able to download or delete with the buttons on the right):
![image](https://github.com/wwaihoe/distributed-file-management-system/assets/91514179/07dc728f-b7a6-44dc-8f24-77a629f174e1)
 
Files are uploaded to MinIO object store:
![image](https://github.com/wwaihoe/distributed-file-management-system/assets/91514179/43687622-d8ba-4c8b-ad2a-b14a8544edc0)
##
## Setup
Docker to run multiple containers/services:
##
1. Web application front-end (webapp)
- Node.js, Express.js
-	User-interface
    -	Shows all files and their attributes.
    -	Provides upload/download/remove functionality for user.
##
2. Application logic (applogic)
-	Node.js, Express.js, Multer
-	Keeps track of files and their attributes in the current state.
-	Checks if file in upload/download/remove request is in storage.
##
3. MinIO object storage client (minioclient)
-	Node.js, Express.js, MinIO
-	MinIO client sends presigned link for uploading upon receiving valid upload request.
-	Handles removal of files from MinIO object store.
-	Sends presigned download link generated by MinIO upon receiving valid 
download request.
##
4. MinIO object storage server (minioserver)
-	minio/minio image from docker hub
-	Starts MinIO object storage server instance for MinIO client to connect to.
##
![image](https://github.com/wwaihoe/distributed-file-management-app-docker/assets/91514179/f1df17b2-81e7-4311-a9a7-a7dcfba2c690)
### Flow of events
a. Upload
1. Web app takes in file as user input.
2. Upon clicking upload button, sends a POST request with the file to app logic.
3. App logic checks for repeated names to avoid naming conflicts.
4. App logic sends GET request to MinIO for presigned URL for file upload.
5. Server with MinIO client sends presigned URL to app logic.
6. App logic sends PUT request with file to be uploaded to the presigned URL to upload file to MinIO.
7. Upon successful upload, app logic keeps track of the file and its attributes.
##
b. Download
1. Upon clicking download button, web app sends POST request with the file to app logic.
2. App logic checks if file exists.
3. If exists, app logic sends POST request with filename to server with MinIO client.
4. Server with MinIO client sends presigned URL to app logic.
5. App logic sends the URL back to the web app for download to commence.
##
c. Remove
1. Upon clicking the remove button, web app sends POST request with the file to app logic.
2. App logic checks if file exists.
3. If exists, app logic sends POST request with filename to server with MinIO client.
4. Server with MinIO client removes file from MinIO bucket.
##
d. Refresh page
1. Every time the window loads, web app sends a GET request to app logic.
2. App logic sends the array of files and their attributes to web app.
3. Web app loads each file and its attributes onto the page.
##
### Steps to start web app:
1. Navigate to folder with “compose.yaml”.
2. Run “docker compose up --build” to build docker containers and run multi-container 
instance.
3. In host machine, access web application through localhost:8000 (port forwarded 
from docker container to host machine).
Note: As signature used to generate presigned URL for file download is based on 
endpoint of minioserver container, for file download to work on browser of host 
machine, you will need to include add minioserver as host in etc/hosts file. (Add entry: 
“127.0.0.1 minioserver”)
